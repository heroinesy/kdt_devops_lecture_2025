<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600">
  <!-- 배경 -->
  <rect width="900" height="600" fill="#f8f9fa"/>
  
  <!-- 제목 -->
  <text x="450" y="40" font-size="26" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    "누가 무엇을 할 수 있는가?" - 인증과 인가
  </text>
  
  <!-- 사용자 영역 -->
  <g id="users">
    <text x="100" y="90" font-size="16" font-weight="bold" fill="#34495e">사용자</text>
    
    <!-- 일반 고객 -->
    <rect x="50" y="100" width="120" height="80" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
    <text x="110" y="125" font-size="14" text-anchor="middle">👤</text>
    <text x="110" y="145" font-size="13" font-weight="bold" text-anchor="middle">일반 고객</text>
    <text x="110" y="165" font-size="11" text-anchor="middle" fill="#666">홍길동</text>
    
    <!-- 프리미엄 고객 -->
    <rect x="190" y="100" width="120" height="80" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
    <text x="250" y="125" font-size="14" text-anchor="middle">⭐</text>
    <text x="250" y="145" font-size="13" font-weight="bold" text-anchor="middle">프리미엄 고객</text>
    <text x="250" y="165" font-size="11" text-anchor="middle" fill="#666">김철수</text>
    
    <!-- 관리자 -->
    <rect x="330" y="100" width="120" height="80" fill="#ffebee" stroke="#f44336" stroke-width="2" rx="5"/>
    <text x="390" y="125" font-size="14" text-anchor="middle">👨‍💼</text>
    <text x="390" y="145" font-size="13" font-weight="bold" text-anchor="middle">관리자</text>
    <text x="390" y="165" font-size="11" text-anchor="middle" fill="#666">이영희</text>
    
    <!-- 배송 기사 -->
    <rect x="470" y="100" width="120" height="80" fill="#e8f5e8" stroke="#4caf50" stroke-width="2" rx="5"/>
    <text x="530" y="125" font-size="14" text-anchor="middle">🚚</text>
    <text x="530" y="145" font-size="13" font-weight="bold" text-anchor="middle">배송 기사</text>
    <text x="530" y="165" font-size="11" text-anchor="middle" fill="#666">박기사</text>
  </g>
  
  <!-- 인증 단계 -->
  <g id="authentication">
    <rect x="50" y="210" width="540" height="80" fill="#fff3e0" stroke="#ff9800" stroke-width="3" rx="8"/>
    <text x="320" y="235" font-size="16" font-weight="bold" text-anchor="middle" fill="#e65100">
      1단계: 인증 (Authentication) - "누구인가?"
    </text>
    
    <!-- OAuth2 + JWT -->
    <rect x="70" y="245" width="240" height="35" fill="#fff" stroke="#ff9800" stroke-width="2" rx="4"/>
    <text x="190" y="265" font-size="12" font-weight="bold" text-anchor="middle">🔐 OAuth2 + JWT</text>
    <text x="190" y="278" font-size="10" text-anchor="middle" fill="#666">로그인 → 토큰 발급</text>
    
    <!-- mTLS -->
    <rect x="330" y="245" width="240" height="35" fill="#fff" stroke="#ff9800" stroke-width="2" rx="4"/>
    <text x="450" y="265" font-size="12" font-weight="bold" text-anchor="middle">🔒 mTLS</text>
    <text x="450" y="278" font-size="10" text-anchor="middle" fill="#666">서비스 간 인증서</text>
  </g>
  
  <!-- 인가 단계 -->
  <g id="authorization">
    <rect x="50" y="320" width="540" height="220" fill="#e8f5e8" stroke="#4caf50" stroke-width="3" rx="8"/>
    <text x="320" y="345" font-size="16" font-weight="bold" text-anchor="middle" fill="#2e7d32">
      2단계: 인가 (Authorization) - "무엇을 할 수 있는가?"
    </text>
    
    <!-- 일반 고객 권한 -->
    <g id="customer-permissions">
      <rect x="70" y="360" width="110" height="160" fill="#fff" stroke="#2196f3" stroke-width="2" rx="4"/>
      <text x="125" y="380" font-size="12" font-weight="bold" text-anchor="middle" fill="#1976d2">일반 고객</text>
      
      <text x="75" y="400" font-size="11" fill="#333">✅ 상품 조회</text>
      <text x="75" y="420" font-size="11" fill="#333">✅ 장바구니</text>
      <text x="75" y="440" font-size="11" fill="#333">✅ 주문 생성</text>
      <text x="75" y="460" font-size="11" fill="#333">✅ 내 주문 조회</text>
      <text x="75" y="480" font-size="11" fill="#999">❌ 타인 주문 조회</text>
      <text x="75" y="500" font-size="11" fill="#999">❌ 관리자 기능</text>
    </g>
    
    <!-- 프리미엄 고객 권한 -->
    <g id="premium-permissions">
      <rect x="195" y="360" width="110" height="160" fill="#fff" stroke="#ff9800" stroke-width="2" rx="4"/>
      <text x="250" y="380" font-size="12" font-weight="bold" text-anchor="middle" fill="#f57c00">프리미엄</text>
      
      <text x="200" y="400" font-size="11" fill="#333">✅ 일반 고객 권한</text>
      <text x="200" y="420" font-size="11" fill="#333">✅ 무료 배송</text>
      <text x="200" y="440" font-size="11" fill="#333">✅ 우선 배송</text>
      <text x="200" y="460" font-size="11" fill="#333">✅ 특가 상품</text>
      <text x="200" y="480" font-size="11" fill="#999">❌ 타인 주문 조회</text>
      <text x="200" y="500" font-size="11" fill="#999">❌ 관리자 기능</text>
    </g>
    
    <!-- 관리자 권한 -->
    <g id="admin-permissions">
      <rect x="320" y="360" width="110" height="160" fill="#fff" stroke="#f44336" stroke-width="2" rx="4"/>
      <text x="375" y="380" font-size="12" font-weight="bold" text-anchor="middle" fill="#d32f2f">관리자</text>
      
      <text x="325" y="400" font-size="11" fill="#333">✅ 모든 주문 조회</text>
      <text x="325" y="420" font-size="11" fill="#333">✅ 주문 수정</text>
      <text x="325" y="440" font-size="11" fill="#333">✅ 사용자 관리</text>
      <text x="325" y="460" font-size="11" fill="#333">✅ 통계 조회</text>
      <text x="325" y="480" font-size="11" fill="#333">✅ 시스템 설정</text>
      <text x="325" y="500" font-size="11" fill="#999">❌ 결제 정보</text>
    </g>
    
    <!-- 배송 기사 권한 -->
    <g id="driver-permissions">
      <rect x="445" y="360" width="110" height="160" fill="#fff" stroke="#4caf50" stroke-width="2" rx="4"/>
      <text x="500" y="380" font-size="12" font-weight="bold" text-anchor="middle" fill="#388e3c">배송 기사</text>
      
      <text x="450" y="400" font-size="11" fill="#333">✅ 배송 목록</text>
      <text x="450" y="420" font-size="11" fill="#333">✅ 배송 주소</text>
      <text x="450" y="440" font-size="11" fill="#333">✅ 배송 상태 변경</text>
      <text x="450" y="460" font-size="11" fill="#999">❌ 고객 전화번호</text>
      <text x="450" y="480" font-size="11" fill="#999">❌ 결제 정보</text>
      <text x="450" y="500" font-size="11" fill="#999">❌ 타 기사 배송</text>
    </g>
  </g>
  
  <!-- 실제 API 호출 예시 -->
  <g id="api-examples">
    <text x="650" y="90" font-size="16" font-weight="bold" fill="#34495e">실제 API 호출</text>
    
    <!-- 성공 케이스 -->
    <rect x="620" y="100" width="250" height="180" fill="#e8f5e8" stroke="#4caf50" stroke-width="2" rx="5"/>
    <text x="745" y="125" font-size="14" font-weight="bold" text-anchor="middle" fill="#2e7d32">✅ 허용</text>
    
    <text x="630" y="150" font-size="11" font-family="monospace" fill="#333">GET /api/orders/123</text>
    <text x="630" y="165" font-size="10" fill="#666">+ JWT (고객 본인)</text>
    <text x="630" y="180" font-size="10" fill="#2e7d32">→ 200 OK</text>
    
    <text x="630" y="205" font-size="11" font-family="monospace" fill="#333">POST /api/orders</text>
    <text x="630" y="220" font-size="10" fill="#666">+ JWT (일반 고객)</text>
    <text x="630" y="235" font-size="10" fill="#2e7d32">→ 201 Created</text>
    
    <text x="630" y="260" font-size="11" font-family="monospace" fill="#333">GET /api/admin/users</text>
    <text x="630" y="275" font-size="10" fill="#666">+ JWT (관리자)</text>
    <text x="630" y="290" font-size="10" fill="#2e7d32">→ 200 OK</text>
    
    <!-- 실패 케이스 -->
    <rect x="620" y="300" width="250" height="180" fill="#ffebee" stroke="#f44336" stroke-width="2" rx="5"/>
    <text x="745" y="325" font-size="14" font-weight="bold" text-anchor="middle" fill="#c62828">❌ 거부</text>
    
    <text x="630" y="350" font-size="11" font-family="monospace" fill="#333">GET /api/orders/456</text>
    <text x="630" y="365" font-size="10" fill="#666">+ JWT (타인 주문)</text>
    <text x="630" y="380" font-size="10" fill="#c62828">→ 403 Forbidden</text>
    
    <text x="630" y="405" font-size="11" font-family="monospace" fill="#333">DELETE /api/users/789</text>
    <text x="630" y="420" font-size="10" fill="#666">+ JWT (일반 고객)</text>
    <text x="630" y="435" font-size="10" fill="#c62828">→ 403 Forbidden</text>
    
    <text x="630" y="460" font-size="11" font-family="monospace" fill="#333">GET /api/payments/123</text>
    <text x="630" y="475" font-size="10" fill="#666">+ JWT (배송 기사)</text>
    <text x="630" y="490" font-size="10" fill="#c62828">→ 403 Forbidden</text>
  </g>
  
  <!-- 하단 설명 -->
  <g id="footer">
    <rect x="50" y="560" width="820" height="30" fill="#ecf0f1" stroke="#95a5a6" stroke-width="1" rx="4"/>
    <text x="460" y="580" font-size="12" text-anchor="middle" fill="#2c3e50">
      💡 핵심: 인증(누구) + 인가(무엇) = 안전한 시스템 | 모든 요청마다 검증 | 최소 권한 원칙
    </text>
  </g>
</svg>
